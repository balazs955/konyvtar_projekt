<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Könyvek</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container">
    <h2>Könyvek</h2>
    <form id="konyv-form">
        <div class="form-group">
            <label for="name">Cím</label>
            <input type="text" class="form-control" id="cim" placeholder="adj meg egy címet">
        </div>
        <div class="form-group">
            <label for="name">Szerző</label>
            <input type="text" class="form-control" id="szerzo" placeholder="Add meg a neved">
        </div>
        <div class="form-group">
            <label for="name">Kiadási év</label>
            <input type="text" class="form-control" id="kiadasi_ev" placeholder="Add meg a neved">
        </div>
        <div class="form-group">
            <label for="message">megjegyzés</label>
            <textarea class="form-control" id="megjegyzes" placeholder="Írd ide az üzeneted"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Könyv Publikálás</button>
    </form>
    <ul id="konyv-list" class="list-group mt-4"></ul>
</div>
<script src="https://www.gstatic.com/firebasejs/9.8.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.8.1/firebase-firestore-compat.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBcuvyGjUxyCmtmNBCmLVERw72BR3Cab-Y",
        authDomain: "konyvek-22c0e.firebaseapp.com",
        projectId: "konyvek-22c0e",
        storageBucket: "konyvek-22c0e.appspot.com",
        messagingSenderId: "339257789513",
        appId: "1:339257789513:web:419b7cd3242076b3114398"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore(app);

    document.getElementById('konyv-form').addEventListener('submit', function (e) {
        e.preventDefault();
        const cim = document.getElementById('cim').value;
        const szerzo = document.getElementById('szerzo').value;
        const kiadasi_ev = document.getElementById('kiadasi_ev').value;
        const megjegyzes = document.getElementById('megjegyzes').value;

        db.collection("konyvek").add({
            konyv_cim: cim,
            konyv_szerzo: szerzo,
            konyv_kiadasi_ev: kiadasi_ev,
            konyv_megjegyzes: megjegyzes
        })
            .then((docRef) => {
                console.log(docRef.id)
            })
            .catch((error) => {
                console.error(error);
            });
    });

    db.collection("konyvek").onSnapshot((querySnapshot) => {
        const konyvekList = document.getElementById('konyv-list');
        konyvekList.innerHTML = '';
        const documents = querySnapshot.docs;
        for (let i = 0; i < documents.length; i++) {
            let msg = documents[i].data();
            const li = document.createElement('li');
            li.classList.add('list-group-item');
            li.innerText = `${msg.konyv_cim}: ${msg.konyv_szerzo}: ${msg.konyv_kiadasi_ev}: ${msg.konyv_megjegyzes}`;
            konyvekList.appendChild(li);
        }
    });
</script>
</body>
</html>
